

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="懂一点点">
  <meta name="author" content="Gotcha">
  <meta name="keywords" content="">
  
  <title>MySQL基础 - Gotcha的笔记总结</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"cd190160b5401a029cee361d013e32a1","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"U8yaiFQ2fUef4ujWTig83mSL-gzGzoHsz","app_key":"akCMytdeJqrMuKP84F4oblqz","server_url":"https://u8yaifq2.lc-cn-n1-shared.com"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Gotcha的笔记总结</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/background/01.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="MySQL基础">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-06-10 00:00" pubdate>
        2020年6月10日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      169
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">MySQL基础</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2020年6月10日 凌晨
                
              </p>
            
            <div class="markdown-body">
              <h1 id="一、Mysql介绍"><a href="#一、Mysql介绍" class="headerlink" title="一、Mysql介绍"></a>一、Mysql介绍</h1><h2 id="1-1-概述"><a href="#1-1-概述" class="headerlink" title="1.1 概述"></a>1.1 概述</h2><p><strong>数据库</strong></p>
<ul>
<li>存储数据的仓库</li>
<li>本质上是一个文件系统，还是以文件的方式存在服务器的电脑上的。</li>
<li>所有的关系型数据库都可以使用通用的SQL语句进行管理</li>
</ul>
<h2 id="1-2-基本操作"><a href="#1-2-基本操作" class="headerlink" title="1.2 基本操作"></a>1.2 基本操作</h2><ul>
<li>MySQL服务启动<ol>
<li>手动。</li>
<li>cmd–&gt; services.msc 打开服务的窗口</li>
<li>使用管理员打开cmd<ul>
<li>net start mysql : 启动mysql的服务</li>
<li>net stop mysql:关闭mysql服务</li>
</ul>
</li>
</ol>
</li>
<li>MySQL登录<ol>
<li>mysql -uroot -p密码</li>
<li>mysql -hip -uroot -p连接目标的密码</li>
<li>mysql –host=ip –user=root –password=连接目标的密码</li>
</ol>
</li>
<li>MySQL退出<ol>
<li>exit</li>
<li>quit</li>
</ol>
</li>
</ul>
<h1 id="二、SQL介绍"><a href="#二、SQL介绍" class="headerlink" title="二、SQL介绍"></a>二、SQL介绍</h1><h2 id="2-1-SQL概述"><a href="#2-1-SQL概述" class="headerlink" title="2.1 SQL概述"></a>2.1 SQL概述</h2><p><strong>Structured Query Language</strong>：结构化查询语言<br>定义了操作所有关系型数据库的规则。每一种数据库操作的方式存在不一样的地方，称为“方言”。</p>
<h3 id="SQL通用语法"><a href="#SQL通用语法" class="headerlink" title="SQL通用语法"></a>SQL通用语法</h3><ul>
<li>SQL 语句可以单行或多行书写，以分号结尾。</li>
<li>可使用空格和缩进来增强语句的可读性。</li>
<li>MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。</li>
<li>包括3种注释<ul>
<li>单行注释: – 注释内容 或 # 注释内容(mysql 特有) </li>
<li>多行注释: /* 注释 */</li>
</ul>
</li>
</ul>
<h3 id="SQL分类"><a href="#SQL分类" class="headerlink" title="SQL分类"></a>SQL分类</h3><ul>
<li><strong>DDL</strong>(Data Definition Language)数据定义语言<br>用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等</li>
<li><strong>DML</strong>(Data Manipulation Language)数据操作语言<br>用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等</li>
<li><strong>DQL</strong>(Data Query Language)数据查询语言<br>用来查询数据库中表的记录(数据)。关键字：select, where 等</li>
<li><strong>DCL</strong>(Data Control Language)数据控制语言(了解)<br>用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE 等</li>
</ul>
<h2 id="2-2-DDL"><a href="#2-2-DDL" class="headerlink" title="2.2 DDL"></a>2.2 DDL</h2><h3 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h3><h4 id="C-Create-创建"><a href="#C-Create-创建" class="headerlink" title="C(Create):创建"></a>C(Create):创建</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#创建数据库：<br>	create database 数据库名称;<br>#创建数据库，判断不存在，再创建：<br>	create database if not exists 数据库名称;<br>#创建数据库，并指定字符集<br>	create database 数据库名称 character set 字符集名;<br></code></pre></td></tr></table></figure>
<h4 id="R-Retrieve-：查询"><a href="#R-Retrieve-：查询" class="headerlink" title="R(Retrieve)：查询"></a>R(Retrieve)：查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询所有数据库的名称:<br>	show databases;<br>#查询某个数据库的字符集:查询某个数据库的创建语句<br>	show create database 数据库名称;<br></code></pre></td></tr></table></figure>

<h4 id="U-Update-修改"><a href="#U-Update-修改" class="headerlink" title="U(Update):修改"></a>U(Update):修改</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#修改数据库的字符集<br>	alter database 数据库名称 character set 字符集名称;<br></code></pre></td></tr></table></figure>

<h4 id="D-Delete-删除"><a href="#D-Delete-删除" class="headerlink" title="D(Delete):删除"></a>D(Delete):删除</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#删除数据库<br>	drop database 数据库名称;<br>#判断数据库存在，存在再删除<br>	drop database if exists 数据库名称;<br></code></pre></td></tr></table></figure>

<h4 id="使用数据库"><a href="#使用数据库" class="headerlink" title="使用数据库"></a>使用数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询当前正在使用的数据库名称<br>	select database();<br>#使用数据库<br>	use 数据库名称;<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="操作表"><a href="#操作表" class="headerlink" title="操作表"></a>操作表</h3><h4 id="C-Create-创建-1"><a href="#C-Create-创建-1" class="headerlink" title="C(Create):创建"></a>C(Create):创建</h4><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">create table 表名(<br>    列名1 数据类型1,<br>    列名2 数据类型2,<br>    ....<br>    列名n 数据类型n<br>);<br></code></pre></td></tr></table></figure>

<blockquote>
<p>最后一列，不需要加逗号（,）</p>
</blockquote>
<p><strong>数据类型</strong></p>
<ul>
<li><p>int：整数类型</p>
</li>
<li><p>double:小数类型</p>
</li>
<li><p>date:日期，只包含年月日，yyyy-MM-dd</p>
</li>
<li><p>datetime:日期，包含年月日时分秒     yyyy-MM-dd HH:mm:ss</p>
</li>
<li><p>timestamp:时间错类型    包含年月日时分秒     yyyy-MM-dd HH:mm:ss    </p>
<ul>
<li>如果不给这个字段赋值，或赋值为null，则默认使用当前的系统时间，来自动赋值</li>
</ul>
</li>
<li><p>varchar：字符串</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#创建表<br>create table student(<br>    id int,<br>    name varchar(32),<br>    age int ,<br>    score double(4,1),<br>    birthday date,<br>    insert_time timestamp<br>);<br># 复制表：<br>	create table 表名 like 被复制的表名;	<br></code></pre></td></tr></table></figure>

<h4 id="R-Retrieve-：查询-1"><a href="#R-Retrieve-：查询-1" class="headerlink" title="R(Retrieve)：查询"></a>R(Retrieve)：查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询某个数据库中所有的表名称<br>	show tables;<br>#查询表结构<br>	desc 表名;<br></code></pre></td></tr></table></figure>

<h4 id="U-Update-修改-1"><a href="#U-Update-修改-1" class="headerlink" title="U(Update):修改"></a>U(Update):修改</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#修改表名<br>alter table 表名 rename to 新的表名;<br>#修改表的字符集<br>alter table 表名 character set 字符集名称;<br>#添加一列<br>alter table 表名 add 列名 数据类型;<br>#修改列名称 类型<br>alter table 表名 change 列名 新列别 新数据类型;<br>alter table 表名 modify 列名 新数据类型;<br>#删除列<br>alter table 表名 drop 列名;<br></code></pre></td></tr></table></figure>

<h4 id="D-Delete-删除-1"><a href="#D-Delete-删除-1" class="headerlink" title="D(Delete):删除"></a>D(Delete):删除</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">drop table 表名;<br>drop table  if exists 表名 ;<br></code></pre></td></tr></table></figure>

<h2 id="2-3-DML"><a href="#2-3-DML" class="headerlink" title="2.3 DML"></a>2.3 DML</h2><h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">insert into 表名(列名1,列名2,...列名n) values(值1,值2,...值n);<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li>列名和值要一一对应</li>
<li>如果表名后，不定义列名，则默认给所有列添加值<ul>
<li><code>insert into 表名 values(值1,值2,...值n);</code></li>
</ul>
</li>
<li>除了数字类型，其他类型需要使用引号(单双都可以)引起来</li>
</ul>
<hr>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">delete from 表名 [where 条件]<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li><p> <strong>如果不加条件，则删除表中所有记录</strong></p>
</li>
<li><p>如果要删除所有记录</p>
<ul>
<li>```mysql<br> delete from 表名; – 不推荐使用。有多少条记录就会执行多少次删除操作<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>- ```mysql<br>  <span class="hljs-keyword">TRUNCATE</span> <span class="hljs-keyword">TABLE</span> 表名; <span class="hljs-comment">-- 推荐使用，效率更高 先删除表，然后再创建一张一样的表。</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<hr>
<h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">update 表名 set 列名1 = 值1, 列名2 = 值2,... [where 条件];<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li><strong>如果不加任何条件，则修改表中所有记录</strong></li>
</ul>
<h2 id="2-4-DQL"><a href="#2-4-DQL" class="headerlink" title="2.4 DQL"></a>2.4 DQL</h2><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select<br>	字段列表<br>from<br>	表名列表<br>	where<br>		条件列表<br>    group by<br>    	分组字段<br>	having<br>    	分组之后的条件<br>	order by<br>    	排序<br>	limit<br>    	分页限定<br></code></pre></td></tr></table></figure>

<h3 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h3><h4 id="多字段的查询"><a href="#多字段的查询" class="headerlink" title="多字段的查询"></a>多字段的查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select 字段名1，字段名2... from 表名；<br></code></pre></td></tr></table></figure>

<h4 id="去除重复"><a href="#去除重复" class="headerlink" title="去除重复"></a>去除重复</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">distinct<br></code></pre></td></tr></table></figure>

<h4 id="计算列"><a href="#计算列" class="headerlink" title="计算列"></a>计算列</h4><ul>
<li> 一般可以使用四则运算计算一些列的值。（一般只会进行数值型的计算）</li>
<li>ifnull(表达式1,表达式2)：null参与的运算，计算结果都为null<ul>
<li>表达式1：哪个字段需要判断是否为null</li>
<li>如果该字段为null后的替换值。</li>
</ul>
</li>
</ul>
<h4 id="起别名"><a href="#起别名" class="headerlink" title="起别名"></a>起别名</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">as #as可以省略<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3><ul>
<li>where子句后跟条件</li>
<li>运算符<ul>
<li><code>&gt;</code> <code>&lt;</code> <code>&lt;=</code> <code>&gt;=</code> <code>=</code> <code>&lt;&gt;</code></li>
<li><code>BETWEEN...AND</code></li>
<li><code>IN( 集合) </code></li>
<li><code>LIKE</code>：模糊查询<ul>
<li>占位符:<ul>
<li> _:单个任意字符</li>
<li>%：多个任意字符</li>
</ul>
</li>
</ul>
</li>
<li><code>IS NULL</code></li>
<li><code>AND  </code>或 <code>&amp;&amp;</code></li>
<li><code>OR  </code>或 <code>||</code> </li>
<li><code>NOT</code>或 <code>!</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">order by 子句<br>#order by 排序字段1 排序方式1 ，  排序字段2 排序方式2...<br></code></pre></td></tr></table></figure>

<p><strong>排序方式</strong></p>
<ul>
<li>ASC：升序，默认的</li>
<li>DESC：降序</li>
</ul>
<blockquote>
<p>如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件</p>
</blockquote>
<hr>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><p><strong>含义</strong></p>
<p>将一列数据作为一个整体，进行纵向的计算</p>
<p><strong>常用函数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#计算个数<br>count<br>	#一般选择非空的列：主键<br>	#count(*)<br>	<br>#计算最大值<br>max<br><br>#计算最小值<br>min<br><br>#计算和<br>sum<br><br>#计算平均值<br>avg<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<p>聚合函数的计算，注意排除null值</p>
<p><strong>解决方法</strong></p>
<ul>
<li>选择不包含非空的列进行计算</li>
<li><code>IFNULL</code>函数</li>
</ul>
<hr>
<h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">group by 分组字段；<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li>分组之后查询的字段：分组字段、聚合函数-</li>
<li>where 和 having 的区别<ul>
<li><strong>where在分组之前</strong>进行限定，如果不满足条件，则不参与分组。<strong>having在分组之后</strong>进行限定，如果不满足结果，则不会被查询出来</li>
<li>where后不可以跟聚合函数，having可以进行聚合函数的判断。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">limit 开始的索引,每页查询的条数;<br></code></pre></td></tr></table></figure>

<p><strong>公式</strong></p>
<p>开始的索引 = （当前的页码 - 1） * 每页显示的条数</p>
<p><strong>注意</strong></p>
<blockquote>
<p>limit 是一个MySQL”方言”</p>
</blockquote>
<hr>
<h2 id="2-5-DCL"><a href="#2-5-DCL" class="headerlink" title="2.5 DCL"></a>2.5 DCL</h2><h3 id="管理用户"><a href="#管理用户" class="headerlink" title="管理用户"></a>管理用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#添加用户：<br>CREATE USER &#x27;用户名&#x27;@&#x27;主机名&#x27; IDENTIFIED BY &#x27;密码&#x27;;<br><br>#删除用户：<br>DROP USER &#x27;用户名&#x27;@&#x27;主机名&#x27;;<br><br>#修改用户密码：			<br>UPDATE USER SET PASSWORD = PASSWORD(&#x27;新密码&#x27;) WHERE USER = &#x27;用户名&#x27;;<br>UPDATE USER SET PASSWORD = PASSWORD(&#x27;abc&#x27;) WHERE USER = &#x27;lisi&#x27;;<br>			<br>SET PASSWORD FOR &#x27;用户名&#x27;@&#x27;主机名&#x27; = PASSWORD(&#x27;新密码&#x27;);<br>SET PASSWORD FOR &#x27;root&#x27;@&#x27;localhost&#x27; = PASSWORD(&#x27;123&#x27;);<br><br>#查询用户<br>#1. 切换到mysql数据库<br>USE myql;<br>#2. 查询user表<br>SELECT * FROM USER;<br></code></pre></td></tr></table></figure>

<h3 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询权限<br>	SHOW GRANTS FOR &#x27;用户名&#x27;@&#x27;主机名&#x27;;<br>	SHOW GRANTS FOR &#x27;lisi&#x27;@&#x27;%&#x27;;<br><br>#授予权限<br>grant 权限列表 on 数据库名.表名 to &#x27;用户名&#x27;@&#x27;主机名&#x27;;<br>-- 给张三用户授予所有权限，在任意数据库任意表上<br>GRANT ALL ON *.* TO &#x27;zhangsan&#x27;@&#x27;localhost&#x27;;<br><br>#撤销权限<br>revoke 权限列表 on 数据库名.表名 from &#x27;用户名&#x27;@&#x27;主机名&#x27;;<br>REVOKE UPDATE ON db3.`account` FROM &#x27;lisi&#x27;@&#x27;%&#x27;;<br></code></pre></td></tr></table></figure>



<h1 id="三、约束"><a href="#三、约束" class="headerlink" title="三、约束"></a>三、约束</h1><p><strong>作用</strong></p>
<p>对表中的数据进行限定，保证数据的正确性、有效性和完整性</p>
<h2 id="3-1-主键约束"><a href="#3-1-主键约束" class="headerlink" title="3.1 主键约束"></a>3.1 主键约束</h2><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>主键约束（primary key），能够唯一确定表中的一条记录。我们通过给某个字段添加该约束，就可以使得该字段不重复且不为空。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#在创建表时，添加主键约束<br>create table stu(<br>    id INT primary key,-- 给id添加主键约束<br>    name VARCHAR(20)<br>);<br><br>#联合主键<br>CREATE TABLE stu (<br>	id INT,<br>	name VARCHAR(20),<br>    PRIMARY KEY(id, name) -- 此处字段id和name一同作为主键，联合主键要求每个字段加起来不同即可（无需每个字段都不同）<br>);<br><br>#删除主键<br>	ALTER TABLE stu DROP PRIMARY KEY;<br><br>#创建完表后，添加主键<br>	ALERT TABLE stu ADD PRIMARY KEY (id);<br>	#或<br>	ALTER TABLE stu MODIFY id INT PRIMARY KEY;<br></code></pre></td></tr></table></figure>

<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>主键非空且唯一</li>
<li>主键就是表中记录的唯一标识</li>
</ul>
<hr>
<h2 id="3-2-自增约束"><a href="#3-2-自增约束" class="headerlink" title="3.2 自增约束"></a>3.2 自增约束</h2><h3 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h3><p>如果某一列是数值类型的，使用 auto_increment 可以来完成值得自动增长</p>
<h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#在创建表时，添加主键约束，并且完成主键自增长<br>create table stu(<br>    id int primary key auto_increment,-- 给id添加主键约束,自增约束<br>    name varchar(20)<br>);<br><br>#删除自动增长<br>ALTER TABLE stu MODIFY id INT;<br><br>#添加自动增长<br>ALTER TABLE stu MODIFY id INT AUTO_INCREMENT;<br></code></pre></td></tr></table></figure>

<h3 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h3><p>自增约束一般<strong>与主键搭配使用</strong></p>
<hr>
<h2 id="3-3-唯一约束"><a href="#3-3-唯一约束" class="headerlink" title="3.3 唯一约束"></a>3.3 唯一约束</h2><h3 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a>作用</h3><p>唯一约束修饰的字段不可以重复</p>
<h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#在创建表时，添加主键约束，并且完成主键自增长,唯一约束<br>create table stu(<br>    id int primary key auto_increment UNIQUE,-- 给id添加主键约束,自增约束，唯一约束<br>    name varchar(20)<br>);<br><br>#或<br>CREATE TABLE stu (<br>	id int primary key auto_increment，<br>	name VARCHAR(20),<br>    UNIQUE(id, name)<br>);<br><br>#删除唯一约束<br>ALTER TABLE stu DROP INDEX phone_number;<br><br>#在创建表后，添加唯一约束<br>ALTER TABLE stu MODIFY phone_number VARCHAR(20) UNIQUE;<br></code></pre></td></tr></table></figure>

<h3 id="注意-2"><a href="#注意-2" class="headerlink" title="注意"></a>注意</h3><ul>
<li>mysql中，唯一约束限定的列的值可以有多个null</li>
<li>sqlserver中，唯一约束限定的列的只能有一个null</li>
</ul>
<hr>
<h2 id="3-4-非空约束"><a href="#3-4-非空约束" class="headerlink" title="3.4 非空约束"></a>3.4 非空约束</h2><h3 id="作用-3"><a href="#作用-3" class="headerlink" title="作用"></a>作用</h3><p>非空约束（not null）约束的字段，值不能为null</p>
<h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#创建表时添加约束<br>CREATE TABLE stu(<br>    id INT,<br>    NAME VARCHAR(20) NOT NULL -- name为非空<br>);<br><br>#删除name的非空约束<br>ALTER TABLE stu MODIFY NAME VARCHAR(20);<br><br>#创建表完后，添加非空约束<br>ALTER TABLE stu MODIFY NAME VARCHAR(20) NOT NULL;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="3-5-默认约束"><a href="#3-5-默认约束" class="headerlink" title="3.5 默认约束"></a>3.5 默认约束</h2><h3 id="作用-4"><a href="#作用-4" class="headerlink" title="作用"></a>作用</h3><p>我们插入字段时没有传值，就会<strong>使用默认值</strong></p>
<h3 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#创建表时添加约束<br>CREATE TABLE stu (<br>	id INT DEFAULT 10,<br>	name VARCHAR(20),<br>);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="3-6-外键约束"><a href="#3-6-外键约束" class="headerlink" title="3.6 外键约束"></a>3.6 外键约束</h2><h3 id="作用-5"><a href="#作用-5" class="headerlink" title="作用"></a>作用</h3><p>外键约束（foreign key）让表于表产生关系，从而保证数据的正确性。</p>
<h3 id="语法-5"><a href="#语法-5" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#在创建表时，可以添加外键<br>create table 表名(<br>    ....<br>    外键列<br>    constraint 外键名称 foreign key (外键列名称) references 主表名称(主表列名称)<br>);<br><br>#删除外键<br>ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;<br><br>#创建表之后，添加外键<br>ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称);<br></code></pre></td></tr></table></figure>

<h3 id="注意-3"><a href="#注意-3" class="headerlink" title="注意"></a>注意</h3><ul>
<li>主表中没有的数据，在副表中是不可以使用的</li>
<li>主表中的数据被副表引用时，是不可以删除的</li>
</ul>
<hr>
<h2 id="3-7-级联操作"><a href="#3-7-级联操作" class="headerlink" title="3.7 级联操作"></a>3.7 级联操作</h2><h3 id="语法-6"><a href="#语法-6" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#添加级联操作<br>ALTER TABLE 表名 ADD CONSTRAINT 外键名称 <br>FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称) ON UPDATE CASCADE ON DELETE CASCADE  ;<br><br>#分类：<br>	#级联更新<br>	ON UPDATE CASCADE <br>	#级联删除<br>	ON DELETE CASCADE <br></code></pre></td></tr></table></figure>

<h1 id="四、范式"><a href="#四、范式" class="headerlink" title="四、范式"></a>四、范式</h1><p><strong>概念</strong></p>
<p>设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。</p>
<blockquote>
<p>目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式(4NF）和第五范式（5NF，又称完美范式）</p>
</blockquote>
<h2 id="4-1-第一范式"><a href="#4-1-第一范式" class="headerlink" title="4.1 第一范式"></a>4.1 第一范式</h2><p>第一范式（1NF）：每一列都是<strong>不可分割</strong>的<strong>原子</strong>数据项。即，<strong>字段还可以拆分的，就不满足第一范式</strong></p>
<h2 id="4-2-第二范式"><a href="#4-2-第二范式" class="headerlink" title="4.2 第二范式"></a>4.2 第二范式</h2><p>第二范式（2NF）：在1NF的基础上，非码属性必须<strong>完全依赖</strong>于码（在1NF基础上消除非主属性对主码的部分函数依赖）。即，<strong>除主键外的每一列，都必须完全依赖于主键</strong>，如果出现不完全依赖，则只可能发生在<strong>联合主键</strong>的情况下</p>
<ul>
<li><strong>不满足第二范式的例子</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE order(<br>	product_id INT,<br>	customer_id INT,<br>	product_name VARCHAR(20),<br>	customer_name VARCHAR(20),<br>    PRIMARY KEY(product_id, customer_id)<br>);<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>满足第二范式的例子</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE order(<br>	id INT PRIMARY KEY,<br>	product_id INT,<br>	customer_id INT<br>);<br><br>CREATE TABLE product(<br>	id INT PRIMARY KEY,<br>	name VARCHAR(20)<br>);<br><br>CREATE TABLE customer(<br>	id INT PRIMARY KEY,<br>    name VARCHAR(20)<br>);<br></code></pre></td></tr></table></figure>

<p><strong>几个概念</strong></p>
<blockquote>
<ol>
<li>函数依赖：A–&gt;B,如果通过A属性(属性组)的值，可以确定唯一B属性的值。则称B依赖于A<br>   例如：学号–&gt;姓名。  （学号，课程名称） –&gt; 分数</li>
<li>完全函数依赖：A–&gt;B， 如果A是一个属性组，则B属性值得确定需要依赖于A属性组中所有的属性值。<br>   例如：（学号，课程名称） –&gt; 分数（同时用学号，课程名称才能确定分数）</li>
<li>部分函数依赖：A–&gt;B， 如果A是一个属性组，则B属性值得确定只需要依赖于A属性组中某一些值即可。<br>   例如：（学号，课程名称） – &gt; 姓名（只用学号就确定了姓名）</li>
<li>传递函数依赖：A–&gt;B, B – &gt;C . 如果通过A属性(属性组)的值，可以确定唯一B属性的值，在通过B属性（属性组）的值可以确定唯一C属性的值，则称 C 传递函数依赖于A<br>   例如：学号–&gt;系名，系名–&gt;系主任</li>
<li>码：如果在一张表中，一个属性或属性组，被其他所有属性所完全依赖，则称这个属性(属性组)为该表的码<br>   例如：该表中码为：（学号，课程名称）<ul>
<li>主属性：码属性组中的所有属性</li>
<li>非主属性：除过码属性组的属性</li>
</ul>
</li>
</ol>
</blockquote>
<h2 id="4-3-第三范式"><a href="#4-3-第三范式" class="headerlink" title="4.3 第三范式"></a>4.3 第三范式</h2><p>第三范式（3NF）：在2NF基础上，任何非主属性不依赖于其它非主属性（在2NF基础上消除传递依赖），即除主键外的其他列之间不能有传递依赖关系</p>
<ul>
<li><strong>不满足第三范式的例子</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE order(<br>	id INT PRIMARY KEY,<br>	product_id INT,<br>	customer_id INT,<br>	customer_phone INT<br>);<br>#此处customer_phone又依赖于customer_id，存在传递依赖关系，不满足第三范式<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>满足第三范式的例子</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE order(<br>	id INT PRIMARY KEY,<br>	product_id INT,<br>	customer_id INT<br>);<br><br>CREATE TABLE customer(<br>	id INT PRIMARY KEY,<br>    name VARCHAR(20),<br>    phone INT<br>);<br></code></pre></td></tr></table></figure>

<hr>
<h1 id="五、多表查询"><a href="#五、多表查询" class="headerlink" title="五、多表查询"></a>五、多表查询</h1><h2 id="5-1-概览"><a href="#5-1-概览" class="headerlink" title="5.1 概览"></a>5.1 概览</h2><p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.1.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>最下面两种语句MySQL中不适用，改为分别左右查询之后进行union操作</p>
</blockquote>
<h2 id="5-2-实际操作"><a href="#5-2-实际操作" class="headerlink" title="5.2 实际操作"></a>5.2 实际操作</h2><h3 id="建表语句"><a href="#建表语句" class="headerlink" title="建表语句"></a>建表语句</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE `t_dept` (<br>`id` INT(11) NOT NULL AUTO_INCREMENT, `deptName` VARCHAR(30) DEFAULT NULL, `address` VARCHAR(40) DEFAULT NULL, PRIMARY KEY (`id`)<br>) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;<br>CREATE TABLE `t_emp` (<br>`id` INT(11) NOT NULL AUTO_INCREMENT, `name` VARCHAR(20) DEFAULT NULL, `age` INT(3) DEFAULT NULL, `deptId` INT(11) DEFAULT NULL, empno INT NOT NULL, PRIMARY KEY (`id`), KEY `idx_dept_id` (`deptId`)<br>#CONSTRAINT `fk_dept_id` FOREIGN KEY (`deptId`) REFERENCES `t_dept` (`id`)<br>) ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;华山&#x27;,&#x27;华山&#x27;);<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;丐帮&#x27;,&#x27;洛阳&#x27;);<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;峨眉&#x27;,&#x27;峨眉山&#x27;);<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;武当&#x27;,&#x27;武当山&#x27;);<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;明教&#x27;,&#x27;光明顶&#x27;);<br>INSERT INTO t_dept(deptName,address) VALUES(&#x27;少林&#x27;,&#x27;少林寺&#x27;);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;风清扬&#x27;,90,1,100001);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;岳不群&#x27;,50,1,100002);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;令狐冲&#x27;,24,1,100003);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;洪七公&#x27;,70,2,100004);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;乔峰&#x27;,35,2,100005);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;灭绝师太&#x27;,70,3,100006);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;周芷若&#x27;,20,3,100007);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;张三丰&#x27;,100,4,100008);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;张无忌&#x27;,25,5,100009);<br>INSERT INTO t_emp(NAME,age,deptId,empno) VALUES(&#x27;韦小宝&#x27;,18,NULL,100010);<br></code></pre></td></tr></table></figure>

<h3 id="JOIN查询"><a href="#JOIN查询" class="headerlink" title="JOIN查询"></a>JOIN查询</h3><h4 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_dept, t_emp;<br></code></pre></td></tr></table></figure>

<p>t_dept共10条记录，t_emp共6条记录。两表共同查询后共60条记录</p>
<h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a INNER JOIN t_dept b ON  a.deptId = b.id;<br></code></pre></td></tr></table></figure>

<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.2.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>隐式内连接：使用where条件消除无用数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a , t_dept b WHERE  a.deptId = b.id;<br></code></pre></td></tr></table></figure>
</blockquote>
<h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a LEFT JOIN t_dept b ON  a.deptId = b.id;<br></code></pre></td></tr></table></figure>

<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.3.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a RIGHT JOIN t_dept b ON  a.deptId = b.id;<br></code></pre></td></tr></table></figure>

<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.4.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="左外连接取左表的独有部分（即，查询没有门派的人）"><a href="#左外连接取左表的独有部分（即，查询没有门派的人）" class="headerlink" title="左外连接取左表的独有部分（即，查询没有门派的人）"></a>左外连接<strong>取左表的独有部分</strong>（即，查询没有门派的人）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a LEFT JOIN t_dept b ON  a.deptId = b.id WHERE a.deptId IS NULL;<br></code></pre></td></tr></table></figure>

<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.5.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="右外连接取右表的独有部分（即，查询没有人的门派）"><a href="#右外连接取右表的独有部分（即，查询没有人的门派）" class="headerlink" title="右外连接取右表的独有部分（即，查询没有人的门派）"></a>右外连接<strong>取右表的独有部分</strong>（即，查询没有人的门派）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM t_emp a RIGHT JOIN t_dept b ON a.deptId = b.id WHERE a.deptId IS NULL;<br></code></pre></td></tr></table></figure>

<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.6.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>注意：判断字段是否为NULL时，<strong>不能使用’=’</strong></p>
<p>因为<code>= NULL</code>的结果不会报错，但是<strong>结果永远为false</strong>。所以必须使用<code>IS NULL</code>来进行判空</p>
</blockquote>
<h4 id="全外连接"><a href="#全外连接" class="headerlink" title="全外连接"></a>全外连接</h4><blockquote>
<p>MySQL不支持全外连接，要查询两个表的全集，需要合并两个查询结果，所以要使用 <strong>UNION</strong> 关键字</p>
</blockquote>
<p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.7.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="查询两表独有"><a href="#查询两表独有" class="headerlink" title="查询两表独有"></a>查询两表独有</h4><p><img src="/2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/Mysql%E5%9F%BA%E7%A1%80/mysql%E5%9F%BA%E7%A1%80/5.8.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h2 id="5-3-子查询"><a href="#5-3-子查询" class="headerlink" title="5.3 子查询"></a>5.3 子查询</h2><p><strong>概念</strong></p>
<p>查询中嵌套查询，称嵌套查询为子查询。</p>
<p><strong>子查询不同情况</strong></p>
<ul>
<li><p>子查询的结果是单行单列的</p>
<ul>
<li><p>查询可以作为条件，使用运算符去判断。 运算符： &gt; &gt;= &lt; &lt;= =</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询员工工资小于平均工资的人<br>SELECT * FROM emp WHERE emp.salary &lt; (SELECT AVG(salary) FROM emp);<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>子查询的结果是多行单列的</p>
<ul>
<li><p>子查询可以作为条件，使用运算符in来判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询&#x27;财务部&#x27;和&#x27;市场部&#x27;所有的员工信息<br>SELECT * FROM emp WHERE dept_id IN (SELECT id FROM dept WHERE NAME = &#x27;财务部&#x27; OR NAME = &#x27;市场部&#x27;);<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>子查询的结果是多行多列的</p>
<ul>
<li><p>子查询可以作为一张虚拟表参与查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#查询员工入职日期是2011-11-11日之后的员工信息和部门信息<br>SELECT * FROM dept t1 ,(SELECT * FROM emp WHERE emp.`join_date` &gt; &#x27;2011-11-11&#x27;) t2 WHERE t1.id = t2.dept_id;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<hr>
<h1 id="六、事务"><a href="#六、事务" class="headerlink" title="六、事务"></a>六、事务</h1><p><strong>概念</strong></p>
<p>事务是一个最小的不可分割的单元，事务能够保证一个业务的完整性</p>
<p>多条sql语句<strong>要么同时成功，要么同时失败</strong>，这时就要用到事务</p>
<h2 id="6-1-操作"><a href="#6-1-操作" class="headerlink" title="6.1 操作"></a>6.1 操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#开启事务<br>start transaction;<br><br>#回滚<br>rollback;<br><br>#提交<br>commit;<br></code></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li>MySQL数据库中事务默认自动提交， Oracle数据库默认是手动提交事务</li>
<li>事务提交的两种方式<ul>
<li>自动提交，一条DML(增删改)语句会自动提交一次事务</li>
<li>手动提交，需要先开启事务，再提交</li>
</ul>
</li>
<li>修改事务的默认提交方式<ul>
<li>查看事务的默认提交方式：SELECT @@autocommit; – 1 代表自动提交  0 代表手动提交</li>
<li>修改默认提交方式： set @@autocommit = 0;</li>
</ul>
</li>
</ul>
<h2 id="6-2-事务的特征"><a href="#6-2-事务的特征" class="headerlink" title="6.2 事务的特征"></a>6.2 事务的特征</h2><ul>
<li>原子性（atomicity）：事务是最小操作的单位，<strong>不可再分</strong>，同一事务中的sql语句<strong>要么同时成功，要么同时失败</strong></li>
<li>一致性（consistency）：事务操作前后，数据总量不变。</li>
<li>隔离性（isolation）：多个事务之间。相互独立。</li>
<li>持久性（durability）：事物<strong>一旦结束</strong>（commit），就<strong>不可返回</strong>（rollback），即持久化</li>
</ul>
<h2 id="6-2-事务的隔离级别"><a href="#6-2-事务的隔离级别" class="headerlink" title="6.2 事务的隔离级别"></a>6.2 事务的隔离级别</h2><p> <strong>概念</strong>：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题</p>
<h3 id="事务的并发问题"><a href="#事务的并发问题" class="headerlink" title="事务的并发问题"></a>事务的并发问题</h3><ul>
<li><p>脏读：：一个事务，读取到另一个事务中没有提交的数据</p>
<blockquote>
<p>事务A读取到了事务B没有Commit的数据，然后<strong>B回滚操作</strong>，那么<strong>A读取到的数据是脏数据</strong></p>
</blockquote>
</li>
<li><p>不可重复读：在同一个事务中，两次读取到的数据不一样。</p>
<blockquote>
<p>事务 A 多次读取同一数据，事务B在事务A多次读取的过程中，对数据作了<strong>更新并提交</strong>，<strong>导致事务A多次读取同一数据时，结果不一致</strong></p>
</blockquote>
</li>
<li><p>幻读：一个事务操作(DML)数据表中所有记录，另一个事务添加了一条数据，第一个事务查询批量处理之后，查询到了另一个事务新增的数据。</p>
<blockquote>
<p>系统管理员A将数据库中所有学生的成绩从具体分数改为ABCDE等级，但是系统管理员B就在这个时候插入了一条具体分数的记录，当系统管理员A改结束后发现还有一条记录没有改过来，就好像发生了幻觉一样</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>注：<strong>不可重复读侧重于修改，幻读侧重于新增或删除</strong></p>
</blockquote>
<hr>
<h3 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别"></a>事务的隔离级别</h3><ul>
<li>读未提交 read uncommitted</li>
<li>读已提交 read committed</li>
<li>可以重复读 repeatable read</li>
<li>串行化 serializable</li>
</ul>
<table>
<thead>
<tr>
<th>事务隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>读未提交（read uncommitted）</td>
<td>未解决</td>
<td>未解决</td>
<td>未解决</td>
</tr>
<tr>
<td>读已提交 （read committed）</td>
<td>解决</td>
<td>未解决</td>
<td>未解决</td>
</tr>
<tr>
<td>可以重复读 （repeatable read）</td>
<td>解决</td>
<td>解决</td>
<td>未解决</td>
</tr>
<tr>
<td>串行化 （serializable）</td>
<td>解决</td>
<td>解决</td>
<td>解决</td>
</tr>
</tbody></table>
<blockquote>
<p>注：</p>
<ul>
<li><p>隔离级别从小到大安全性越来越高，但是效率越来越低</p>
</li>
<li><p>解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</p>
</li>
</ul>
</blockquote>
<p><strong>操作</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">#数据库查询隔离级别,版本 5.x<br>select @@tx_isolation;<br>#数据库查询隔离级别,版本 8.0<br>SELECT @@global.transaction_isolation;<br><br>#数据库设置隔离级别：<br>set global transaction isolation level  级别字符串;<br></code></pre></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
                    
                      <a class="hover-with-bg" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/">MySQL</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/MySQL/">MySQL</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/08/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis%E5%9F%BA%E7%A1%80/Redis%E5%9F%BA%E7%A1%80/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Redis基础</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/03/11/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/Git/Git%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">
                        <span class="hidden-mobile">Git</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
    
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>









  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>




  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?cd190160b5401a029cee361d013e32a1";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
